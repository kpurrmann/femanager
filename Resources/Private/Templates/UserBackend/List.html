{namespace femanager=In2code\Femanager\ViewHelpers}
{namespace core=TYPO3\CMS\Core\ViewHelpers}
<f:layout name="Backend"/>

UserBackend / List

<f:section name="main">

	<div class="typo3-TCEforms">
		<div role="tabpanel">
			<ul class="nav nav-tabs t3js-tabs" role="tablist" id="tabs-DTM-af56df637b" data-store-last-tab="1">
				<f:if condition="{approveUsers}">
					<f:then>
						<li role="presentation" class="t3js-tabmenu-item active">
							<a href="#DTM-af56df637b-1" title="" aria-controls="DTM-af56df637b-1" role="tab" data-toggle="tab">
								Approve Users
							</a>
						</li>
						<li role="presentation" class="t3js-tabmenu-item">
							<a href="#DTM-af56df637b-2" title="" aria-controls="DTM-af56df637b-2" role="tab" data-toggle="tab">
								Manage Users
							</a>
						</li>
					</f:then>
					<f:else>
						<li role="presentation" class="t3js-tabmenu-item">
							<a href="#DTM-af56df637b-1" title="" aria-controls="DTM-af56df637b-1" role="tab" data-toggle="tab">
								Approve Users
							</a>
						</li>
						<li role="presentation" class="t3js-tabmenu-item active">
							<a href="#DTM-af56df637b-2" title="" aria-controls="DTM-af56df637b-2" role="tab" data-toggle="tab">
								Manage Users
							</a>
						</li>
					</f:else>
				</f:if>

			</ul>
		</div>

		<div class="tab-content">
			<f:if condition="{approveUsers}">
				<f:then>
					<div role="tabpanel" class="tab-pane active" id="DTM-af56df637b-1">
				</f:then>
				<f:else>
					<div role="tabpanel" class="tab-pane" id="DTM-af56df637b-1">
				</f:else>
			</f:if>
				<fieldset class="form-section">
					<h3>Open Approvals ({approveUsers -> f:count()})</h3>
					<f:if condition="{approveUsers}">
						<f:then>
							<table class="table table-hover table-condensed">
								<tr>
									<th>Actions</th>
									<th>UID</th>
									<th>Created</th>
									<th>Username</th>
									<th>Location</th>
									<th>E-Mail / Link to domain</th>
									<th>Name</th>
								</tr>
								<f:for each="{approveUsers}" as="user">
									<tr>
										<td>
											<div class="btn-group">
												<f:link.action action="approveUser" arguments="{userID: user}" class="btn btn-primary btn-sm"><i class="fa fa-check"></i></f:link.action>
												<f:link.action action="declineUser" arguments="{userID: user}" class="btn btn-danger btn-sm"><i class="fa fa-times"></i></f:link.action>
											</div>
										</td>
										<td>{user.uid}</td>
										<td><f:format.date format="d.m.Y - H:i:s">{user.crdate}</f:format.date></td>
										<td>{user.username}</td>
										<td>{user.location}</td>
										<td><f:link.external target="_blank" title="Open in {user.emailDomain} new window" uri="{user.emailDomain}">{user.email}</f:link.external></td>
										<td>{user.name}</td>
									</tr>
								</f:for>
							</table>
						</f:then>
						<f:else>
							<p>No open approvals</p>
						</f:else>
					</f:if>
				</fieldset>
			</div>
			<f:if condition="{approveUsers}">
				<f:then>
					<div role="tabpanel" class="tab-pane" id="DTM-af56df637b-2">
				</f:then>
				<f:else>
					<div role="tabpanel" class="tab-pan active" id="DTM-af56df637b-2">
				</f:else>
			</f:if>

				<fieldset class="form-section">
					<div class="femanager_list">
						<f:render partial="Misc/FlashMessages" arguments="{_all}" />
						<f:render partial="Backend/Searchform" />
						<f:if condition="{users}">
							<f:then>
								<f:be.widget.paginate objects="{users}" as="usersPage" configuration="{itemsPerPage: 100, insertBelow: 1}">
									<div class="table-fit">
									<table cellspacing="0" cellpadding="0" border="0" class="table table-striped table-hover">
										<tbody>

										<tr class="t3-row-header">
											<td nowrap="nowrap" class="col-icon">&nbsp;</td>
											<td nowrap="nowrap" colspan="9">
									<span class="c-table">
										<f:translate key="tx_femanager_domain_model_user" />
									</span>
									(<f:count subject="{users}" />)
								</td>
								<td nowrap="nowrap" class="col-icon">&nbsp;</td>
							</tr>
							<tr class="c-headLine">
								<td nowrap="nowrap" class="col-icon">
									<a title="Create New User" href="{femanager:Misc.BackendNewLink(tableName:'fe_users')}">
										<core:icon identifier="actions-document-new" />
									</a>
								</td>
								<td nowrap="nowrap" class="col-icon">
											</td>
											<td nowrap="nowrap" class="col-title">
												<f:translate key="tx_femanager_domain_model_user.username" />
											</td>
											<td nowrap="nowrap">
												<f:translate key="tx_femanager_domain_model_user.email" />
											</td>
											<td nowrap="nowrap">
												<f:translate key="tx_femanager_domain_model_user.name" />
											</td>
											<td nowrap="nowrap">
												<f:translate key="tx_femanager_domain_model_user.usergroup" />
											</td>
											<td nowrap="nowrap"class="col-icon">Actions</td>
											<td nowrap="nowrap">
												<f:translate key="tx_femanager_domain_model_user.lastlogin" />
											</td>
											<td nowrap="nowrap">
												UID
											</td>
											<td nowrap="nowrap">
												PID
											</td>
										</tr>
							<f:for each="{usersPage}" as="user">
								<tr class="db_list_normal firstcol femanager_list_line">
									<td nowrap="nowrap" class="col-icon">
										<span title="id={user.uid}"
											  class="tx-feusermanager-icon-status-user-frontend"
											  style="{f:if(condition:'{user.disable}', then:'display:none', else:'')}">
											<core:icon identifier="status-user-frontend" />
										</span>
										<span title="id={user.uid} - {f:translate(key:'BackendListUserVisibilityHidden')}"
											  class="tx-feusermanager-icon-status-user-frontend-disabled"
											  style="{f:if(condition:'{user.disable}', then:'', else:'display:none')}">
											<core:icon identifier="status-user-frontend" state="disabled" />
										</span>
									</td>
									<td nowrap="nowrap" class="col-icon">
										<span title="{f:translate(key:'BackendListUserStatusOnline')}"
											  class="tx-feusermanager-icon-status-status-permission-granted"
											  style="{f:if(condition:'{user.online}', then:'', else:'display:none')}">
											<core:icon identifier="status-status-permission-granted" />
										</span>
										<span title="{f:translate(key:'BackendListUserStatusOffline')}"
											  class="tx-feusermanager-icon-status-status-permission-denied"
											  style="{f:if(condition:'{user.online}', then:'display:none', else:'')}">
											<core:icon identifier="status-status-permission-denied" />
										</span>
									</td>
									<td nowrap="nowrap" class="col-title">
										{user.username}
									</td>
									<td nowrap="nowrap">
										{user.email}
									</td>
									<td nowrap="nowrap">
										{user.lastName}<f:if condition="{user.lastName}">,</f:if> {user.firstName}
									</td>
									<td nowrap="nowrap">
										<f:for each="{user.usergroup}" as="usergroup" iteration="i">
											<f:if condition="{i.isFirst}">
												<f:else>
													<br />
												</f:else>
											</f:if>
											{usergroup.title}
										</f:for>
									</td>
									<td nowrap="nowrap">
										<f:comment>
											Edit Icon
										</f:comment>
										<a title="{f:translate(key:'BackendListUserEdit')}" href="{femanager:Misc.BackendEditLink(tableName:'fe_users',identifier:user.uid)}">
											<core:icon identifier="actions-document-open" />
										</a>

										<f:comment>
											Delete Icon
										</f:comment>
										<span class="deleteUser cursorpointer" title="{f:translate(key:'BackendListUserDelete')}">
											<core:icon identifier="actions-edit-delete" />
										</span>

										<f:comment>
											Enable/Disable Icon
										</f:comment>
										<span title="{f:translate(key: 'BackendListUserVisibilityUnhide')}"
											  class="unhideUser cursorpointer tx-feusermanager-icon-actions-edit-unhide"
											  style="{f:if(condition:'{user.disable} == 1', then:'', else:'display:none')}">
											<core:icon identifier="actions-edit-unhide" />
										</span>
										<span title="{f:translate(key: 'BackendListUserVisibilityHide')}"
											  class="hideUser cursorpointer tx-feusermanager-icon-actions-edit-hide"
											  style="{f:if(condition:'{user.disable} == 1', then:'display:none', else:'')}">
											<core:icon identifier="actions-edit-hide" />
										</span>

										<f:comment>
											Login as Icon
										</f:comment>
										<span title="{f:translate(key:'BackendListLoginAs')}"
											  class="tx-feusermanager-icon-actions-system-backend-user-switch"
											  style="{f:if(condition:'{user.online} == 1', then:'display:none', else:'{f:if(condition:\'{user.disable}\', then:\'display:none\', else:\'\')}')}">
											<a href="/?eID=femanagerLoginAs&user={user.uid}" title="{f:translate(key: 'BackendListLoginAs')}" target="_blank">
												<core:icon identifier="actions-system-backend-user-switch" />
											</a>
										</span>
										<span title="{f:translate(key:'BackendListLoginAs')}"
											  class="tx-feusermanager-icon-actions-system-backend-user-switch-disabled"
											  style="{f:if(condition:'{user.online} == 1', then:'', else:'{f:if(condition:\'{user.disable}\', then:\'\', else:\'display:none\')}')}">
											<core:icon identifier="actions-system-backend-user-switch" state="disabled" />
										</span>

										<f:comment>
											Logout Icon
										</f:comment>
										<span title="{f:translate(key:'BackendListUserLogout')}"
											  class="tx-feusermanager-icon-apps-pagetree-drag-place-denied"
											  style="{f:if(condition:'{user.online}', then:'', else:'display:none')}">
											<f:link.action action="userLogout" arguments="{user:user}" class="logoutUser" title="{f:translate(key:'BackendListUserLogout')}">
												<core:icon identifier="apps-pagetree-drag-place-denied" />
											</f:link.action>
										</span>
										<span title="{f:translate(key:'BackendListUserLogout')}"
											  class="tx-feusermanager-icon-apps-pagetree-drag-place-denied-disabled"
											  style="{f:if(condition:'{user.online}', then:'display:none', else:'')}">
											<core:icon identifier="apps-pagetree-drag-place-denied" state="disabled" />
										</span>

										<input type="hidden" class="container_uid" name="container_uid" value="{user.uid}" />
										<input type="hidden" class="container_module_uri" name="container_module_uri" value="{moduleUri}" />
										<input type="hidden" class="container_table" name="container_table" value="fe_users" />
										<input type="hidden" class="container_label_delete_confirmation" name="container_label_delete_confirmation" value="{f:translate(key:'BackendListUserDeleteConfirmation')}" />
									</td>
								<td nowrap="nowrap">
													<f:format.date format="d.m.Y H:i">{user.lastlogin}</f:format.date>
												</td>
												<td nowrap="nowrap">
													{user.uid}
												</td>
												<td nowrap="nowrap">
													{user.pid}
												</td>

											</tr>
							</f:for>

										</tbody>
									</table></div>
								</f:be.widget.paginate>

							</f:then>
							<f:else>
								<div class="femanager_note">
									<f:translate key="noRecordsFound" />
									<br />
									<f:if condition="{femanager:Misc.Request(parameter:'tx_femanager_web_femanagerm1|filter|searchword')}">
										<f:then>
											<f:link.action>
												<f:translate key="noRecordsFoundClearFilter">Clean filter.</f:translate>
											</f:link.action>
										</f:then>
										<f:else>
											<f:if condition="{femanager:Condition.IsBackendAdministratorAuthentication()}">
												<f:link.action class="underline" additionalParams="{id:0}">
													<f:translate key="noRecordsFoundGoToPage0">Show all users from all pages (for admins only).</f:translate>
												</f:link.action>
											</f:if>
										</f:else>
									</f:if>
								</div>
							</f:else>
						</f:if>
					</div>
				</fieldset>
			</div>
		</div>
</f:section>
